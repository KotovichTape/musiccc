{% extends "rental/base.html" %}

{% block title %}–ö–∞–±–∏–Ω–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞{% endblock %}

{% block content %}
<h2>–ö–∞–±–∏–Ω–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞</h2>
<p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ –∞—Ä–µ–Ω–¥—É –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.</p>
<div class="mb-3">
    <a href="{% url 'rental_reports' %}" class="btn btn-outline-primary">–û—Ç—á—ë—Ç—ã –ø–æ –∞—Ä–µ–Ω–¥–µ</a>
    <a href="{% url 'logout' %}" class="btn btn-danger ms-2">–í—ã–π—Ç–∏</a>
</div>

<h3 class="mt-4">üìå –û–∂–∏–¥–∞—é—â–∏–µ –∑–∞—è–≤–∫–∏</h3>
{% if pending_requests %}
<table class="table">
    <tr>
        <th>–ö–ª–∏–µ–Ω—Ç</th>
        <th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th>
        <th>–î–∞—Ç—ã</th>
        <th>–¶–µ–Ω–∞</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
    {% for rental in pending_requests %}
    <tr id="rental-{{ rental.id }}">
        <td>{{ rental.client.user.username }}</td>
        <td>{{ rental.equipment.name }}</td>
        <td>{{ rental.start_date|date:"d.m.Y" }} - {{ rental.end_date|date:"d.m.Y" }}</td>
        <td>{{ rental.total_price }} ‚ÇΩ</td>
        <td class="rental-status">
                üü° –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        </td>
        <td>
            <form method="post" action="{% url 'approve_request' rental.id %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-success btn-sm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </form>
            <form method="post" action="{% url 'reject_request' rental.id %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>‚úÖ –ù–µ—Ç –∑–∞—è–≤–æ–∫, –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.</p>
{% endif %}

<h3 class="mt-4">üìú –ê–∫—Ç–∏–≤–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã</h3>
{% if active_contracts %}
<table class="table">
    <tr>
        <th>–ö–ª–∏–µ–Ω—Ç</th>
        <th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th>
        <th>–î–∞—Ç—ã</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
        <th>–°—É–º–º–∞</th>
    </tr>
    {% for contract in active_contracts %}
    <tr>
        <td>{{ contract.client.user.username }}</td>
        <td>{{ contract.equipment.name }}</td>
        <td>{{ contract.start_date|date:"d.m.Y" }} - {{ contract.end_date|date:"d.m.Y" }}</td>
        <td>üü¢ –ê–∫—Ç–∏–≤–Ω—ã–π</td>
        <td>{{ contract.total_price }} ‚ÇΩ</td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>üì≠ –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤.</p>
            {% endif %}

<h3 class="mt-4">üìä –û–∂–∏–¥–∞—é—â–∏–µ –æ–ø–ª–∞—Ç—ã —Å—á–µ—Ç–∞</h3>
{% if pending_invoices %}
<table class="table">
    <tr>
        <th>–ö–ª–∏–µ–Ω—Ç</th>
        <th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th>
        <th>–°—É–º–º–∞</th>
        <th>–°—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã</th>
        <th>–°—Ç–∞—Ç—É—Å</th>
    </tr>
    {% for invoice in pending_invoices %}
    <tr>
        <td>{{ invoice.contract.client.user.username }}</td>
        <td>{{ invoice.contract.equipment.name }}</td>
        <td>{{ invoice.amount }} ‚ÇΩ</td>
        <td>{{ invoice.due_date|date:"d.m.Y" }}</td>
        <td>üü° –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã</td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>üì≠ –ù–µ—Ç —Å—á–µ—Ç–æ–≤, –æ–∂–∏–¥–∞—é—â–∏—Ö –æ–ø–ª–∞—Ç—ã.</p>
{% endif %}

{% endblock %}